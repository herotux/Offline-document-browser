<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <!-- Package Definition -->
  <Package Name="Utility Documents"
           Manufacturer="herotux"
           Version="1.0.0.0"
           UpgradeCode="c98c2bbc-0bcc-4cc1-8e88-c0acdf806542">

    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />

    <Feature Id="ProductFeature" Title="UtilityDocuments" Level="1">
      <!-- اگر بعدا ComponentGroup استفاده می‌کنید، GUID های خودش را دارد -->
      <ComponentRef Id="ApplicationShortcut" />
    </Feature>
  </Package>

  <!-- Directories -->
  <Fragment>
    <StandardDirectory Id="ProgramFilesFolder">
      <Directory Id="INSTALLFOLDER" Name="UtilityDocuments" />
    </StandardDirectory>

    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="ApplicationProgramsFolder" Name="UtilityDocuments"/>
    </StandardDirectory>
  </Fragment>

  <!-- Shortcut Component -->
  <Fragment>
    <DirectoryRef Id="ApplicationProgramsFolder">
      <Component Id="ApplicationShortcut" Guid="6F9619FF-8B86-D011-B42D-00CF4FC964FF">
        <!-- Shortcut pointing to main exe -->
        <Shortcut Id="ApplicationStartMenuShortcut"
                  Name="Utility Documents"
                  Description="Utility Documents Application"
                  Target="[#UtilityDocuments.exe]"
                  WorkingDirectory="INSTALLFOLDER"/>
        <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall"/>
        <RegistryValue Root="HKCU"
                       Key="Software\herotux\UtilityDocuments"
                       Name="installed"
                       Type="integer"
                       Value="1"
                       KeyPath="yes"/>
      </Component>
    </DirectoryRef>
  </Fragment>
</Wix>
