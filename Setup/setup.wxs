<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <Package Name="Utility Documents" Manufacturer="herotux" Version="1.0.0.0" UpgradeCode="*">
    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />

    <Feature Id="ProductFeature" Title="UtilityDocuments" Level="1">
      <ComponentGroupRef Id="UtilityDocuments.Generated" />
      <ComponentRef Id="ApplicationShortcut" />
    </Feature>
  </Package>

  <Fragment>
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="INSTALLFOLDER" Name="Utility Documents" />
      </Directory>
      <Directory Id="ProgramMenuFolder">
        <Directory Id="ApplicationProgramsFolder" Name="Utility Documents"/>
      </Directory>
    </Directory>
  </Fragment>

  <Fragment>
    <DirectoryRef Id="ApplicationProgramsFolder">
      <Component Id="ApplicationShortcut" Guid="*">
        <!-- The Target is the file ID of the main exe, which will be generated by harvesting.
             We need to know this ID. A common convention is to use the file name. -->
        <Shortcut Id="ApplicationStartMenuShortcut"
                  Name="Utility Documents"
                  Description="Utility Documents Application"
                  Target="[#UtilityDocuments.exe]"
                  WorkingDirectory="INSTALLFOLDER"/>
        <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall"/>
        <RegistryValue Root="HKCU" Key="Software\herotux\UtilityDocuments" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
      </Component>
    </DirectoryRef>
  </Fragment>
</Wix>