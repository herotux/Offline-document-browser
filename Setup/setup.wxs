<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">

  <!-- اطلاعات پکیج -->
  <Package 
    Name="Utility Documents" 
    Manufacturer="herotux" 
    Version="1.0.0.0" 
    UpgradeCode="c98c2bbc-0bcc-4cc1-8e88-c0acdf806542">

    <MajorUpgrade 
      DowngradeErrorMessage="A newer version of [ProductName] is already installed." />

    <Feature Id="ProductFeature" Title="UtilityDocuments" Level="1">
      <ComponentRef Id="MainExeComponent" />
      <ComponentRef Id="AllOtherFilesComponent" />
      <ComponentRef Id="ApplicationShortcut" />
    </Feature>
  </Package>

  <!-- مسیر نصب در Program Files -->
  <Fragment>
    <StandardDirectory Id="ProgramFilesFolder">
      <Directory Id="INSTALLFOLDER" Name="UtilityDocuments" />
    </StandardDirectory>
    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="ApplicationProgramsFolder" Name="UtilityDocuments"/>
    </StandardDirectory>
  </Fragment>

  <!-- فایل اجرایی اصلی -->
  <Fragment>
    <DirectoryRef Id="INSTALLFOLDER">

      <!-- EXE -->
      <Component Id="MainExeComponent" Guid="*">
        <File 
          Id="UtilityDocumentsExe" 
          Source="..\bin\Release\net8.0-windows\UtilityDocuments.exe" 
          KeyPath="yes" />
      </Component>

      <!-- سایر فایل‌ها (HTML + Icon) -->
      <Component Id="AllOtherFilesComponent" Guid="*">
        <File 
          Id="PlaceholderHtmlFile" 
          Source="..\bin\Release\net8.0-windows\placeholder.html" 
          KeyPath="no" />
        <File 
          Id="AppIconFile" 
          Source="..\icon.ico" 
          KeyPath="no" />
      </Component>

    </DirectoryRef>
  </Fragment>

  <!-- شورتکات در Start Menu -->
  <Fragment>
    <DirectoryRef Id="ApplicationProgramsFolder">
      <Component Id="ApplicationShortcut" Guid="*">
        <Shortcut 
          Id="ApplicationStartMenuShortcut"
          Name="Utility Documents"
          Description="Utility Documents Application"
          Target="[#UtilityDocumentsExe]"
          WorkingDirectory="INSTALLFOLDER" />
        <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall" />
        <RegistryValue 
          Root="HKCU" 
          Key="Software\herotux\UtilityDocuments" 
          Name="installed" 
          Type="integer" 
          Value="1" 
          KeyPath="yes" />
      </Component>
    </DirectoryRef>
  </Fragment>

</Wix>
