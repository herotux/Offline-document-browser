<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <Package Name="Utility Documents" Manufacturer="herotux" Version="1.0.0.0" UpgradeCode="c98c2bbc-0bcc-4cc1-8e88-c0acdf806542">
    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />

    <Feature Id="ProductFeature" Title="UtilityDocuments" Level="1">
      <ComponentRef Id="MainExeComponent" />
      <ComponentRef Id="AllOtherFilesComponent" />
      <ComponentRef Id="ApplicationShortcut" />
    </Feature>
  </Package>

  <!-- مسیر نصب فایل‌ها -->
  <Fragment>
    <StandardDirectory Id="ProgramFilesFolder">
      <Directory Id="INSTALLFOLDER" Name="UtilityDocuments" />
    </StandardDirectory>
    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="ApplicationProgramsFolder" Name="UtilityDocuments"/>
    </StandardDirectory>
  </Fragment>

  <!-- Component اصلی: exe -->
  <Fragment>
    <DirectoryRef Id="INSTALLFOLDER">
      <Component Id="MainExeComponent" Guid="d9f8a2c1-1a5b-4c3d-9f6a-0a1b2c3d4e5f">
        <File Id="UtilityDocumentsExe" Source="..\UtilityDocuments\bin\Release\net8.0-windows\UtilityDocuments.exe" KeyPath="yes" />
      </Component>

      <!-- سایر فایل‌ها -->
      <Component Id="AllOtherFilesComponent" Guid="f1e2d3c4-b5a6-7890-1234-56789abcdef0">
        <File Id="PlaceholderHtmlFile" Source="..\UtilityDocuments\bin\Release\net8.0-windows\placeholder.html" KeyPath="no" />
        <File Id="AppIconFile" Source="..\UtilityDocuments\icon.ico" KeyPath="no" />
      </Component>
    </DirectoryRef>
  </Fragment>

  <!-- Component شورتکات -->
  <Fragment>
    <DirectoryRef Id="ApplicationProgramsFolder">
      <Component Id="ApplicationShortcut" Guid="a1b2c3d4-e5f6-7890-1234-56789abcdef1">
        <Shortcut Id="ApplicationStartMenuShortcut"
                  Name="Utility Documents"
                  Description="Utility Documents Application"
                  Target="[#UtilityDocumentsExe]"
                  WorkingDirectory="INSTALLFOLDER"/>
        <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall"/>
        <RegistryValue Root="HKCU" Key="Software\herotux\UtilityDocuments" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
      </Component>
    </DirectoryRef>
  </Fragment>
</Wix>
